let hasMounted=[],hasRendered=[],memoizes={},states={};export const Mounted=(e,t,s=!1)=>{let r=setInterval((()=>{switch(!0){case s&&hasMounted.includes(t.key):return clearInterval(r);case s&&!hasMounted.includes(t.key):hasMounted.push(t.key),e();break;case!document.querySelector(`[key="${t.key}"]`):return;default:e(),clearInterval(r)}}),100)};export class Component{constructor(e){this.state=states[this.constructor.name]||{},this.__internalInstance=null,this.key=e?.key||Component.name+Math.random(),this.checkMount(),this.mounted=!1,this.props={...e,key:this.key}}useKey(e){Object.defineProperty(this,"key",{value:e}),Object.defineProperty(this.props,"key",{value:e})}setState(e){this.state=Object.assign({},this.state,e),this.updateInstance(this.__internalInstance)}useState(e,t){this.state[e]||(this.state[e]=t);let s=this.state[e];const r=()=>this.state[e];return[r,t=>{this.state[e]=t,this.updateInstance(this.__internalInstance),s=r()}]}useRef(e,t){return this.state[e]||(this.state[e]=t),{current:this.state[e]}}onMount(){}domDifference(e,t){let s=[];for(let r=0;r<e.length;r++){let n=e[r],a=t[r];n&&a&&n.childNodes.length>0&&a.childNodes.length>0&&s.push(...this.domDifference(Array.from(n.childNodes),Array.from(a.childNodes))),n.nodeValue!==a.nodeValue&&s.push({type:"replace",old:n,new:a})}return s}checkMount(){if(this.mounted)return;setInterval((()=>{document.querySelector(`[key="${this.key}"]`)&&!this.mounted&&(this.mounted=!0,this.onMount())}))}updateChangedElements(e){e.forEach((e=>{if(e)switch(e.type){case"replace":if(e.old.panrntNode&&"BODY"===e.old.parentNode.nodeName)return;e.old.replaceWith(e.new.cloneNode(!0));break;case"remove":e.old.remove();break;case"attributeSwap":let t=Array.from(e.old.attributes),s=Array.from(e.new.attributes);t.forEach((t=>{e.old.removeAttribute(t.name)})),s.forEach((t=>{e.old.setAttribute(t.name,t.value)}));break;case"add":e.old.appendChild(e.new.cloneNode(!0))}}))}async updateInstance(e,t=!1){let s=document.querySelector(`[key="${this.key}"]`)||document.querySelector("#app").firstChild,r=await vjsxx.render(e,s,{return:!0}),n=t?[{type:"replace",old:s,new:r}]:this.domDifference(Array.from(s.childNodes),Array.from(r.childNodes));this.updateChangedElements(n)}parseStyle(e,t,s={useImportant:!1}){let r="",n=document.head.querySelector("#vader-stylesheet")||document.createElement("style");return n.setAttribute("id","vader-stylesheet"),Object.keys(e).forEach((a=>{let i=e[a],o="",l="";switch(!0){case a.includes("hover"):return o=a.split("hover(")[1].replace(/\)/g,""),l=`.${o}:hover{${this.parseStyle(i,t,{useImportant:!0})}};`,n.innerHTML.includes(l)||(n.innerHTML=l+n.innerHTML),void t.classList.add(o);case a.includes("transition"):let e=`transition:${i} ${s.useImportant?" !important":""};`;r+=e;break;case a.includes("@mobile"):o=a.split("@mobile")[1].replace(/\(/g,"").replace(/\)/g,"");let d=document.createElement("style");d.setAttribute("id","vader-mobile-stylesheet"),l=`@media (max-width: 768px){.${o}{${this.parseStyle(i,t,{useImportant:!0})}};}`,document.head.querySelector("#vader-mobile-stylesheet")||document.head.appendChild(d),document.querySelector("#vader-mobile-stylesheet")&&!document.querySelector("#vader-mobile-stylesheet").innerHTML.includes(l)&&(document.querySelector("#vader-mobile-stylesheet").innerHTML=l+document.querySelector("#vader-mobile-stylesheet").innerHTML),t.classList.add(o);break;case a.includes("@tablet"):o=a.split("@tablet")[1].replace(/\(/g,"").replace(/\)/g,""),l=`@media (min-width: 769px) and (max-width: 1024px){.${o}{${this.parseStyle(i,t,{useImportant:!0})}};}`;let c=document.createElement("style");c.setAttribute("id","vader-tablet-stylesheet"),document.head.querySelector("#vader-tablet-stylesheet")||document.head.appendChild(c),document.head.querySelector("#vader-tablet-stylesheet").innerHTML.includes(l)||(document.head.querySelector("#vader-tablet-stylesheet").innerHTML=l+document.head.querySelector("#vader-tablet-stylesheet").innerHTML),t.classList.add(o);break;case a.includes("@desktop"):o=a.split("@desktop")[1].replace(/\(/g,"").replace(/\)/g,"");let p=document.createElement("style");p.setAttribute("id","vader-desktop-stylesheet"),document.head.querySelector("#vader-desktop-stylesheet")||document.head.appendChild(p),l=`@media (min-width: 1025px){.${o}{${this.parseStyle(i,t,{useImportant:!0})}};}`,document.head.querySelector("#vader-desktop-stylesheet").innerHTML.includes(l)||(document.head.querySelector("#vader-desktop-stylesheet").innerHTML=l+document.head.querySelector("#vader-desktop-stylesheet").innerHTML),t.classList.add(o);break;case a.includes("transform"):let h=`transform:${i} ${s.useImportant?" !important":""};`;r+=h;break;case a.includes("animation"):r+=`animation:${i};`;break;case a.includes("active"):o=a.split("active(")[1].replace(/\)/g,""),l=`.${o}:active{${this.parseStyle(i,t,{useImportant:!0})}};`,n.innerHTML.includes(l)||(n.innerHTML+=l),t.classList.add(o);break;case a.includes("body"):let u=`body{${this.parseStyle(i,t)}};`;return void(document.head.querySelector("#vader-stylesheet").innerHTML.includes(`body{${this.parseStyle(i,t)}};`)||(document.head.querySelector("#vader-stylesheet").innerHTML+=u));case a.includes("focus"):o=a.split("focus(")[1].replace(/\)/g,"");let y=`.${o}:focus{${this.parseStyle(i,t,{useImportant:!0,noReturn:!0})}};`;n.innerHTML.includes(y)||(n.innerHTML+=y),t.classList.add(o);break;case a.includes("before"):o=a.split("before(")[1].replace(/\)/g,"");let m=`.${o}::before{${this.parseStyle(i,t,{useImportant:!0,noReturn:!0})}};`;n.innerHTML.includes(m)||(n.innerHTML+=m),t.classList.add(o);break;case a.includes("after"):o=a.split("after(")[1].replace(/\)/g,"");let f=`.${o}::after{${this.parseStyle(i,t,{useImportant:!0,noReturn:!0})}};`;n.innerHTML.includes(f)||(n.innerHTML+=f),t.classList.add(o);break;case a.includes("placeholder"):o=a.split("placeholder(")[1].replace(/\)/g,"");let k=`.${o}::placeholder{${this.parseStyle(i,t,{useImportant:!0,noReturn:!0})}};`;n.innerHTML.includes(k)||(n.innerHTML+=k),t.classList.add(o);break;case a.includes("first-child"):o=a.split("first-child(")[1].replace(/\)/g,"");let b=`.${o}:first-child{${this.parseStyle(i,t,{useImportant:!0,noReturn:!0})}};`;n.innerHTML.includes(b)||(n.innerHTML+=b),t.classList.add(o);break;case a.includes("last-child"):o=a.split("last-child(")[1].replace(/\)/g,"");let v=`.${o}:last-child{${this.parseStyle(i,t,{useImportant:!0,noReturn:!0})}};`;n.innerHTML.includes(v)||(n.innerHTML+=v),t.classList.add(o);break;case a.includes("nth-child"):o=a.split("nth-child(")[1].replace(/\)/g,"").split("(")[0];let E=`.${o}:nth-child(${a.split("nth-child(")[1].replace(/\)/g,"").split("(")[1]}){${this.parseStyle(i,t,{useImportant:!0,noReturn:!0})}};`;n.innerHTML.includes(E)||(n.innerHTML+=E),t.classList.add(o);break;case a.includes(">"):let L=`${a}{${this.parseStyle(i,t)}};`;n.innerHTML.includes(L)||(n.innerHTML+=L),t.classList.add(o)}a=a.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase(),r+=`${a}:${i} ${s.useImportant?" !important":""};`})),document.head.querySelector("#vader-stylesheet")||document.head.appendChild(n),r}}class vjsx{constructor(){this._vjsx=!0}isClass(e){return/^\s*class\s+/.test(e.toString())}instanizeClass(e,t={}){if("string"==typeof e||"object"==typeof e)return e;switch(this.isClass(e)){case!0:let s=new e(t);return states[e.name]=s.state,s.state=states[e.name],s.$$typeof="vjsx",s.type=e.name,s.key=t?.key||s?.key||s.name,s.props=t,s.__internalInstance=()=>s.render(s.props),s.__internalInstance.bind(s),s.render();case!1:let r=new Component;r.key=e.name+Math.random(),e.$$typeof="vjsx",e.useState=r.useState.bind(r),e.setState=r.setState.bind(r),states[e.name]=r.state,r.state=states[e.name],e.state=r.state;let n={},a={};return t?.router&&(n=t.router.req,a=t.router.res),r.__internalInstance=()=>e.bind(r)(t,n,a),e.apply?e.apply(r,[t,n,a]):e}}createElement(e,t,s,...r){let n="function"==typeof e,a=r.find((e=>"vjsx"===e?.$$typeof));if(n)return t.key=s||Math.random(),t.parent=a,this.instanizeClass(e,t);let i={type:e,RootParent:a,key:s,props:{...t,children:Array.isArray(t.children)?t.children:[t.children]}};return"TEXT_ELEMENT"===("string"==typeof i?"TEXT_ELEMENT":i.type)?createTextElement(i):i}async render(e,t,s){let r=this.instanizeClass(e,s?.passProps);if(s&&s?.passProps&&s?.passProps?.router){let i=s.passProps.router.req,o=s.passProps.router.res;if(i.pause){async function l(){return await new Promise((async e=>{let r=setInterval((()=>{i.pause?o.render&&"function"==typeof o.render&&!hasRendered.includes(o.render.toString())&&(Vader.render(o.render(i,o,s.passProps),t),hasRendered.push(o.render.toString())):(clearInterval(r),e())}),0)}))}await l()}}if(!r.type)return;let n="TEXT_ELEMENT"===r.type?document.createTextNode(""):document.createElement(r.type),a=e=>e.startsWith("on");if(r.props&&(r.props.key&&(r.key=r.props.key),Object.keys(r.props).filter(a).forEach((e=>{let t=e.toLowerCase().substring(2);n.addEventListener(t,r.props[e].bind(r))})),Object.keys(r.props).filter((e=>!a(e))).forEach((e=>{switch(!0){case"className"===e||"class"===e||"classname"===e:n.setAttribute("class",r.props[e]),delete r.props[e];break;case"ref"===e:if(Array.isArray(r.props[e].current))return void r.props[e].current.push(n);r.props[e].current=n,n.removeAttribute("ref");break;case"htmlFor"===e:n.setAttribute("for",r.props[e]);break;case"style"===e:n.setAttribute("style",Component.prototype.parseStyle(r.props[e],n));break;default:"children"!==e&&n.setAttribute(e,r.props[e])}"TEXT_ELEMENT"!==r.type||(n.nodeValue=r.props[e])}))),r.props&&r.props.children&&Array.isArray(r.props.children)&&r.props?.children&&r.props.children.forEach((async e=>{if("number"!=typeof e&&"string"!=typeof e||(e=e.toString()),Array.isArray(e))return void e.forEach((async e=>{null!==e&&await this.render(e,n,!0)}));if(!e)return;let t="function"==typeof e?this.instanizeClass(e):e;"TEXT_ELEMENT"!==(t?.type?t.type:"TEXT_ELEMENT")?await this.render(t,n):n.appendChild(document.createTextNode(t))})),s?.return)return n;r.key&&n.setAttribute("key",r.key),!s?.return&&document.body.contains(t)&&(r?.RootParent?.onMount(),t.innerHTML=""),t.appendChild(n)}}function createTextElement(e){return{type:"TEXT_ELEMENT",props:{nodeValue:e,children:[]}}}export const useState=e=>{this.state[key]||(this.state[key]=e);let t=this.state[key];const s=()=>this.state[key]||e;return t=s(),[s,e=>{t=e,this.state[key]=e,this.updateInstance(this.__internalInstance)}]};export const useReducer=(e,t)=>{const[s,r]=useState(t);return[s,t=>{const n=e(s,t);r(n)}]};export const useRef=e=>{this.state[key]||(this.state[key]=e);let t=this.state[key];return t=(()=>this.state[key]||e)(),[t,e=>{t=e,this.state[key]=e,this.updateInstance(this.__internalInstance)}]};export class Html extends Component{constructor(e){super(e),this.useKey(this?.props?.key||"HTML_ROOT"),this.props=e,this.checkMount()}render(){return $SERVER?(this.props.lang&&document.documentElement.setAttribute("lang",this.props.lang),vjsxx.createElement("div",{children:this.props.children,key:this.key})):vjsxx.createElement("div",{children:this.props.children,key:this.key})}onMount(){this.props?.parent&&this.props?.parent&&this.props.parent.onMount()}}export class Head extends Component{constructor(e){super(e),this.head=document.createElement("div"),this.useKey("head"),this.hasRefreshed=!1}render(){return($SERVER||this.props.refresh&&!memoizes[this.key])&&(async()=>{let e=document.createElement("div");if(Array.isArray(this.props.children))for(let t of this.props.children){let s=await vjsxx.render(t,e,{return:!0}),r=this.head.querySelectorAll("*");for(let e=0;e<r.length;e++)r[e].isEqualNode(s);e.appendChild(s)}Object.keys(this.props).includes("children")&&!Array.isArray(this.props.children)&&this.head.appendChild(vjsxx.render(this.props.children,this.head,{return:!0})),e.querySelectorAll("*").forEach((e=>{switch(e.tagName){case"TITLE":document.title=e.innerHTML;break;case"META":return void(document.querySelector(`meta[name="${e.getAttribute("name")}"]`)||document.head.appendChild(e));case"LINK":return void(document.querySelector(`link[href="${e.getAttribute("href")}"]`)||document.head.appendChild(e));case"SCRIPT":if(!e.hasAttribute("eager"))return void(document.querySelector(`script[src="${e.getAttribute("src")}"]`)||document.head.appendChild(e));if(document.querySelector(`script[srcid="${e.getAttribute("srcid")}"]`))return;fetch(e.src).then((e=>e.text())).then((t=>{let s=document.createElement("script");s.innerHTML=t,s.setAttribute("srcid",e.src),s.setAttribute("type",e.type),s.setAttribute("async",e.async||!1),s.setAttribute("defer",e.defer||!1),oldDocument.querySelector(`script[srcid="${e.src}"]`)||document.head.appendChild(s)})).catch((e=>{console.warn("Error fetching script",e)}));break;default:console.warn("Unknown tag",e.tagName)}}))})(),""}}export class Link extends Component{constructor(e){if(super(e),this.key=e?.key||Math.random(),this.props=e,this.checkMount(),"object"==typeof this.props?.href){let e=this.props?.href?.query?Object.keys(this.props?.href?.query).map((e=>`${e}=${this.props?.href?.query[e]}`)).join("&"):"";this.props.href=this.props?.href?.pathname+(e?`?${e}`:"")}}render(){let e={...this.props,href:this.props?.href,onClick:e=>{switch(e.preventDefault(),!0){case"outside"===this.props.action:e.preventDefault(),window.open(this.props.href,"_blank");break;case"function"==typeof this.props.action:this.props.action(e);break;default:e.preventDefault(),window.history.pushState({},"",this.props.href),window.dispatchEvent(new Event("popstate"))}},key:this.key};return vjsxx.createElement("a",e,this.props?.key,null)}}export class imgComponent extends Component{constructor(e){if(super(e),this.useKey(this?.props?.key||"img"),this.key=this?.props?.key||"img",this.props=e,this.checkMount(),this.isLoaded=!1,!this.key)throw new Error("Key is required for Image component for tracking")}render(){let e=new Image;e.src=this.props?.src,e.onload=()=>{this.props.isLoaded||(this.props.isLoaded=!0,this.isLoaded=!0,this.updateInstance(this.__internalInstance,!0))};let t=vjsxx.createElement("div",{style:{width:this.props?.width,height:this.props?.height,...this?.props?.loader?{}:{background:this.props?.loadColor||"#bcbcbc"},...this?.props?.style},key:this.key,children:[this.props?.loader||""]},this.key,null);return this.isLoaded?vjsxx.createElement("img",{...this.props,style:{ObjectFit:"cover",...this.props?.style},key:this.key},this.key,null):t}}let vjsxx=new vjsx,Vader={createElement:vjsxx.createElement,useState:useState,instanizeClass:vjsxx.instanizeClass,render:vjsxx.render,useRef:useRef,isClass:vjsxx.isClass,Head:Head,Html:Html,Mounted:Mounted,Component:Component,Link:Link,Image:imgComponent};export default Vader;